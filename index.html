<!DOCTYPE html>
<html>
<head>
    <title>CallerDesk CTI</title>

    <!-- ✅ CORRECT: Load Open CTI from Salesforce -->
    <script src="https://callerdesk5-dev-ed.develop.lightning.force.com/support/api/52.0/lightning/opencti_min.js"></script>
</head>

<body>
    <h3>CallerDesk Softphone</h3>

    <script>
        // Wait until Open CTI is available
        window.onload = function () {
            if (!window.sforce || !sforce.opencti) {
                console.error("Open CTI not loaded");
                return;
            }

            // ✅ ENABLE CLICK TO DIAL (THIS ENABLES CALL ICON)
            sforce.opencti.enableClickToDial({
                callback: function (res) {
                    console.log("Click to Dial Enabled", res);
                }
            });

            // ✅ LISTEN FOR CLICK EVENTS
            sforce.opencti.onClickToDial({
                listener: function (payload) {
                    console.log("Click to Dial Payload", payload);
                    alert("Calling: " + payload.number);
                }
            });
        };
    </script>
</body>
</html>
