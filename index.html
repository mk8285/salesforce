<!DOCTYPE html>
<html>
<head>
    <title>CallerDesk CTI</title>

    <!-- Salesforce Open CTI library -->
    <script src="/support/api/52.0/lightning/opencti_min.js"></script>
</head>

<body>
    <h3>CallerDesk Softphone</h3>

    <button onclick="makeCall()">Call</button>
    <button onclick="endCall()">End</button>

    <script>
        // ðŸ”‘ REQUIRED: Enable Click-to-Dial
        sforce.opencti.enableClickToDial({
            callback: function (res) {
                console.log("Click-to-Dial Enabled", res);
            }
        });

        // ðŸ”‘ REQUIRED: Listen for click-to-dial events
        sforce.opencti.onClickToDial({
            listener: function (payload) {
                console.log("Click to Dial Payload:", payload);

                const number = payload.number;
                alert("Calling: " + number);

                // ðŸ”¥ Call your telephony API here
                // ex: Twilio / Exotel / CallerDesk backend
            }
        });

        function makeCall() {
            alert("Manual Call Triggered");
        }

        function endCall() {
            alert("Call Ended");
        }
    </script>
</body>
</html>
